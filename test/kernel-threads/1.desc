Test shared memory, lock and create threads.